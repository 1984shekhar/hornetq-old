<html>
  <head>
    <title>HornetQ JAAS Example</title>
    <link rel="stylesheet" type="text/css" href="../../common/common.css">
  </head>
  <body>
     <h1>JAAS Example</h1>

     <p>This example shows you how to configure HornetQ to use JAAS for security.</p>
     <p>HornetQ can leverage JAAS to delegate user authentication and authorization to existing security infrastructure.</p>
     
     <p>
         The example will show how to configure HornetQ with JAAS in <a href="server0/hornetq-beans.xml">hornetq-beans.xml</a>
         (You would use <literal>hornetq-jboss-beans.xml</literal> if you are running inside JBoss Application
         Server).
         It will use a simple <code>LoginModule</code> without any user interaction.
         The example will create a connection and authenticate the user with this JAAS LoginModule, send a message
         to a queue and receive it (see the <a href="../queue/readme.html">Queue example</a> for a complete description
         of the application code)
     </p>
     <h2>Example setup</h2>
     <p>HornetQ can use a JAAS security manager by specifying it in <a href="server0/hornetq-beans.xml">hornetq-beans.xml</a>:</p>
     <pre>
         <code>
             &amp;lt;!-- The security manager using JAAS --&amp;gt;
             &amp;lt;bean name=&quot;HornetQSecurityManager&quot; class=&quot;org.hornetq.integration.jboss.security.JAASSecurityManager&quot;&amp;gt;
             &amp;lt;property name=&quot;configurationName&quot;&amp;gt;org.hornetq.jms.example.ExampleLoginModule&amp;lt;/property&amp;gt;
             &amp;lt;property name=&quot;configuration&quot;&amp;gt;
             &amp;lt;inject bean=&quot;ExampleConfiguration&quot;/&amp;gt;
             &amp;lt;/property&amp;gt;
             &amp;lt;property name=&quot;callbackHandler&quot;&amp;gt;
             &amp;lt;inject bean=&quot;ExampleCallbackHandler&quot; /&amp;gt;
             &amp;lt;/property&amp;gt;
             &amp;lt;/bean&amp;gt;

             &amp;lt;!-- JAAS uses a simple LoginModule where the user credentials and roles are
             specified as options in the constructor --&amp;gt;
             &amp;lt;bean name=&quot;ExampleConfiguration&quot; class=&quot;org.hornetq.jms.example.ExampleConfiguration&quot;&amp;gt;
             &amp;lt;constructor&amp;gt;
             &amp;lt;parameter&amp;gt;org.hornetq.jms.example.ExampleLoginModule&amp;lt;/parameter&amp;gt;
             &amp;lt;parameter&amp;gt;
             &amp;lt;map class=&quot;java.util.HashMap&quot; keyClass=&quot;java.lang.String&quot;
             valueClass=&quot;java.lang.String&quot;&amp;gt;
             &amp;lt;entry&amp;gt;
             &amp;lt;key&amp;gt;user&amp;lt;/key&amp;gt;
             &amp;lt;value&amp;gt;jboss&amp;lt;/value&amp;gt;
             &amp;lt;/entry&amp;gt;
             &amp;lt;entry&amp;gt;
             &amp;lt;key&amp;gt;pass&amp;lt;/key&amp;gt;
             &amp;lt;value&amp;gt;redhat&amp;lt;/value&amp;gt;
             &amp;lt;/entry&amp;gt;
             &amp;lt;entry&amp;gt;
             &amp;lt;key&amp;gt;role&amp;lt;/key&amp;gt;
             &amp;lt;value&amp;gt;guest&amp;lt;/value&amp;gt;
             &amp;lt;/entry&amp;gt;
             &amp;lt;/map&amp;gt;
             &amp;lt;/parameter&amp;gt;
             &amp;lt;/constructor&amp;gt;
             &amp;lt;/bean&amp;gt;

             &amp;lt;!-- the CallbackHandler does nothing as we don&apos;t have any user interaction --&amp;gt;
             &amp;lt;bean name=&quot;ExampleCallbackHandler&quot; class=&quot;org.hornetq.jms.example.ExampleCallbackHandler&quot;
             /&amp;gt;
         </code>
     </pre>
     
     <ul>
        <li>the HornetQSecurityManager's <code>configurationName</code> must be the name of the Java class implementing <code>LoginModule</code></li>
        <li>the <code>callbackHandler</code> property must be an implementation of <code>CallbackHandler</code>. In this example, the ExampleCallbackHandler
           does nothing since the authentication requires no user interaction</li>
        <li>the <code>configuration</code> property must be an implementation of <code>Configuration</code>. For simplicity, we pass directly the
           user credentials as options to the <code>ExampleConfiguration</code> constructor. These options will be passed to an instance
           of ExampleLoginModule which will check that the only valid user is "jboss" with the password "redhat"
           and it has the role "guest". </li>
     </ul>        

     <h2>Example step-by-step</h2>
     <p><i>To run the example, simply type <code>ant</code> from this directory</i></p>
     <p>The only relevant step with regard to JAAS configuration is step 4 (all the other
        steps are identical to the <a href="../queue/readme.html">Queue example</a>).
     <ol start="4">
        <li>We create a JMS Connection with user "jboss" and password "redhat". Any other
           combination of name and password won't be valid for the ExampleLoginModule</li>
        <pre>
           <code>connection = cf.createConnection("jboss", "redhat");</code>
        </pre>  
     </ol>
        
     <h2>More information</h2>
     
     <ul>
         <li>User Manual's <a href="../../../docs/user-manual/en/html_single/index.html#security">Security chapter</a></li>
     </ul>
  </body>
</html>